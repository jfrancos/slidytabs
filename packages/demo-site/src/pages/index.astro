---
import Demos from "@/components/Demos.astro";
import { getCollection } from "astro:content";
import "github-markdown-css/github-markdown.css";
import { icons } from "@/lib/utils";
import boston from "@/assets/boston.svg";
import DemoText from "@/components/DemoText.astro";

const { github } = icons;
const readme = await getCollection("readme");
const sections = Object.fromEntries(
  readme.map(({ id, rendered }) => [id, rendered?.html]),
);
---

<html lang="en" class=".scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content={Astro.generator} />
    <meta property="og:url" content="https://slidytabs.dev" />
    <meta
      name="description"
      content="slidytabs is a simple utility for animating shadcn <Tabs />"
    />

    <title>slidytabs</title>
  </head>
  <body class="flex flex-col">
    <div class="py-6 bg-zinc-200 color-zinc-700">
      <div
        class="max-w-217 mx-auto w-full px-4 sm:px-12 flex justify-between items-center"
      >
        <!-- bg-transparent and border-0 need !important for build but not dev -->
        <div
          class="markdown-body bg-transparent! [&_p]:text-balance [&_code]:bg-white"
        >
          <section
            class="[&>*:nth-child(4)]:hidden [&>h1]:(color-pink-700 border-0!) children:(my-0! py-0!) flex flex-col gap-2"
            set:html={sections["# slidytabs"]}
          />
        </div>
        <a
          aria-label="visit the slidytabs repo at github"
          href="https://github.com/jfrancos/slidytabs"
          class="hover:bg-zinc-300 p-2.5 -m-2.5 rounded-full transition-colors"
          target="_blank"
          rel="noopener noreferrer"
        >
          <div class:list={[github, "size-7"]}></div>
        </a>
      </div>
    </div>

    <main class="flex flex-col mx-auto w-full max-w-217 px-4 sm:px-12">
      <div class="markdown-body [&_pre]:bg-muted! [&_li]:list-disc">
        <section set:html={sections["## Contents"]} />
        <section set:html={sections["## Why this exists"]} />
        <section set:html={sections["## Install"]} />
        <section set:html={sections["## Usage"]} />
        <section set:html={sections["### Make tabs slide with `tabs()`"]} />
        <h4>Examples</h4>
        <DemoText example="Tabs" />
      </div>
      <Demos filename="Tabs" />
      <div class="markdown-body">
        <DemoText example={"ShadcnControlled"} />
      </div>
      <Demos filename="ShadcnControlled" />
      <div class="markdown-body">
        <DemoText example={"SlidytabsControlled"} />
      </div>
      <Demos filename="SlidytabsControlled" />
      <div class="markdown-body [&_pre]:bg-muted!">
        <section
          set:html={sections["### Make tabs a slider with `slider()`"]}
        />
        <h4>Examples</h4>
        <DemoText example={"Slider"} />
      </div>
      <Demos filename="Slider" />
      <div class="markdown-body">
        <DemoText example={"Sticky"} />
      </div>
      <Demos filename="Sticky" />
      <div class="markdown-body">
        <DemoText example={"Vertical"} />
      </div>
      <Demos filename="Vertical" />

      <div class="markdown-body [&_pre]:bg-muted!">
        <section
          set:html={sections["### Make tabs a range slider with `range()`"]}
        />
        <h4>Examples</h4>
        <DemoText example={"Range"} />
      </div>
      <Demos filename="Range" />
      <div class="markdown-body">
        <DemoText example={"Push"} />
      </div>
      <Demos filename="Push" />
      <div
        class="flex text-xs md:items-end md:justify-between [&_a]:underline pb-4 flex-wrap md:flex-row flex-col items-center md:gap-0 gap-8"
      >
        <div class="flex-1 flex whitespace-nowrap">
          <div class="flex flex-col gap-1.5 items-center">
            <a
              target="_blank"
              rel="noopener noreferrer"
              href="https://docs.astro.build/en/concepts/islands"
              >An Astro archipelago</a
            >
            <a
              class="font-mono text-10px bg-#818b981f rounded-sm px-1 py-0.5 -mx-1 w-fit"
              href="https://github.com/jfrancos/slidytabs/blob/main/packages/demo-site/src/pages/index.astro#sr-footer-heading"
              target="_blank"
              rel="noopener noreferrer"
            >
              querySelectorAll("astro-island").length === <span id="archipelago"
              ></span>
            </a>
          </div>
        </div>
        <div class="flex flex-col items-center gap-1.5 whitespace-nowrap">
          Other projects:
          <a
            href="https://oklch.beauty"
            target="_blank"
            rel="noopener noreferrer">oklch.beauty</a
          >
        </div>
        <div class="flex-1 flex justify-end whitespace-nowrap">
          <div class="flex flex-col items-center">
            <img
              alt="Boston skyline"
              class="opacity-25 h-32 -mt-8"
              src={boston.src}
            />
            Made with love in Camberville, MA
          </div>
        </div>
      </div>
    </main>
  </body>
</html>

<script>
  const numIslands = document.querySelectorAll("astro-island").length;
  const span = document.querySelector("#archipelago");
  if (span) {
    span.textContent = numIslands.toString();
  }
</script>
