---
import { Tabs, TabsList, TabsTrigger, TabsContent } from "@/shadcn/astro/tabs";
import { frameworks, type Framework } from "../lib/store.js";
import * as icons from "../lib/icons";
---

<Tabs defaultValue="react" class="items-center tabs-root">
  <TabsList
    class="*:px-2 *:gap-1 md:*:px-4 md:*:gap-2 *:h-7 rounded-md text-sm"
  >
    {
      frameworks.map((value: Framework) => (
        <TabsTrigger
          {value}
          data-state={value === "react" ? "active" : "inactive"}
        >
          <div class={(icons as Record<Framework, string>)[value]} />
          {value[0].toUpperCase() + value.slice(1)}
        </TabsTrigger>
      ))
    }
  </TabsList>
  {frameworks.map((value) => <TabsContent {value} class="hidden" />)}
</Tabs>

<script>
  import { frameworkAtom, frameworks, setFramework } from "../lib/store.js";
  import { slider } from "slidytabs";

  const frameworkTabs = document.querySelectorAll(".tabs-root");
  for (const frameworkTab of frameworkTabs) {
    frameworkAtom.subscribe((value) => {
      slider({
        value: frameworks.indexOf(value),
        onValueChange: (index) => {
          setFramework(frameworks[index]);
        },
      })(frameworkTab);
    });
  }
</script>
