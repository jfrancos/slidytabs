---
import Code from "./Code.astro";
import SvelteShell from "./svelte/Shell.svelte";
import TsxShell from "./tsx/Shell.tsx";

interface Props {
  filename: string;
  highlight: string;
  lang: "tsx" | "svelte";
}

const { filename, highlight, lang } = Astro.props;
const { default: Component } = await import(
  `./${lang}/examples/${filename}.${lang}`
);
const { default: code } = await import(
  `./${lang}/examples/${filename}.${lang}?raw`
);

const logos = {
  "i-logos:react?mask text-#087EA4": lang === "tsx",
  "i-logos:svelte-icon": lang === "svelte",
};
---

<div class="flex flex-col border-gray-100 border-4 rounded-lg w-xl relative">
  <div class="flex justify-center h-32 items-center relative">
    <div class:list={[logos, "text-xl absolute top-4 right-4"]}></div>
    {lang === "svelte" && <SvelteShell {filename} client:idle />}
    {lang === "tsx" && <TsxShell {filename} client:idle />}
    <!-- flash between SSR awaited component and client awaited component so we
    have both simultaneously and hide the SSR once the client is visible -->
    <div class="[:has(*)~&]:hidden">
      <Component />
    </div>
  </div>
  <Code {highlight} {code} {lang} />
</div>
